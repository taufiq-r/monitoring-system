global:
  scrape_interval: 15s

rule_files:
  - "alert_rules.yml"

alerting:
  alertmanagers:
    - static_configs:
        - targets: ['alertmanager:9093']

scrape_configs:
  - job_name: "prometheus"
    static_configs:
        - targets: ["prometheus:9090"]
#server monitoring 
  - job_name: "Monitoring Server"
    static_configs:
        - targets: ["192.168.51.174:9100"]
          labels:
            server_role: "monitoring"
            environment: "production"
            server: "Server Utama"

  - job_name: "Monitored Server"  #Nama Grup
    static_configs:
      - targets: ["192.168.51.100:9100", "192.168.50.112:9100"]  #Alamat IP server yang dimonito
        labels: 
            server_role: "worker"
            environment: "production"
            server: "Server Backup"
####
  - job_name: 'uptime-kuma'
    scrape_interval: 30s
    scheme: http
    metrics_path: '/metrics'
    static_configs:
      - targets: ['uptime-kuma:3001']
    basic_auth:
      username: admin #
      password: seadmin1  # 


  - job_name: 'snmp'
    static_configs:
      - targets:
        - 192.168.20.130  # IP SNMP device.
        #- switch.local # SNMP device.
        #- tcp://192.168.1.3:1161  # SNMP device using TCP transport and custom port.
    metrics_path: /snmp
    params:
      auth: [public_v2]
      module: [routeros]
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: 192.168.50.210:9116  # The SNMP exporter's real hostname:port.

  # Global exporter-level metrics
  - job_name: 'snmp_exporter'
    static_configs:
      - targets: ['snmp_exporter:9116']
  
  - job_name: 'speedtest_exporter'
    scrape_interval: 1h
    scrape_timeout: 1m
    static_configs:
      - targets: ['speedtest-exporter:9798']
  
  - job_name: "blackbox-http"
    metrics_path: /probe
    params:
       module: [http_2xx]
    static_configs:
      - targets:
          - "https://seamolec.org/"
          - "https://maganghub.kemnaker.go.id"
          - "https://siapkerja.kemnaker.go.id/app/home"
        #labels:
         # vlan: "internet"
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: "blackbox-exporter:9115"

  - job_name: "blackbox-vlan"
    metrics_path: /probe
    params:
       module: [ping]
    static_configs:
      # Contoh gateway IP per VLAN â€” ganti sesuai lingkungan Anda
      - targets:
          - "192.168.10.0"
        labels:
          vlan: "VLAN_10"
          location: "LAN LANTAI 1"
          probe_type: "ping"
      - targets:
          - "192.168.20.0"
        labels:
          vlan: "VLAN_20" 
          location: "LAN LANTAI 2"
          probe_type: "ping"
      - targets:
          - "192.168.30.20"
        labels:
          vlan: "VLAN_30"
          location: "LAN LANTAI 3"
          probe_type: "ping"
      - targets:
          - "192.168.40.20"
        labels:
          vlan: "VLAN_40"
          location: "LAN RUANG IT"
          probe_type: "ping"
      - targets:
          - "192.168.50.0"
        labels:
          vlan: "VLAN_50"
          location: "WLAN"
          probe_type: "ping"
      - targets:
          - "192.168.15.0"
        labels:
          vlan: "WLAN/LAN"
          location: "Ruang Kelas Lt1 dan 2"
          probe_type: "ping"
      - targets: 
          - "192.168.25.0"
        labels:
          vlan: "VLAN25"
          location: "RUANG LAB KOMPUTER"
          probe_type: "ping"
      - targets:
          - "192.168.35.0" 
        labels:
          vlan: "VLAN35"
          location: "RUANG ODL HUB"
          probe_type: "ping"
      - targets:
          - "118.98.214.129"
        labels:
          vlan: "VLAN_100"
          location: "VLAN PUSDATIN"
          probe_type: "ping"
      - targets:
          - "192.168.99.0"
        labels:
          vlan: "VLAN99"
          location: "MANAGEMENT VLAN"
          probe_type: "ping"
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: "blackbox-exporter:9115"
  - job_name: cadvisor
    scrape_interval: 5s
    static_configs:
      - targets:
        - cadvisor:8080

